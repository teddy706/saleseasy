<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>하이오더 POS 연동 상세 가이드</title>
    <link rel="stylesheet" href="css/icloud_inspired_style.css">
    <style>
        .code-block {
            background-color: #f5f5f7;
            border: 1px solid var(--icloud-border);
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
            font-family: 'SF Mono', Consolas, 'Courier New', monospace;
            font-size: 0.9em;
            text-align: left;
            white-space: pre-wrap;
            word-break: break-all;
        }
        .detail-field-group h4 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--icloud-text-primary);
            margin-top: 25px;
            margin-bottom: 10px;
        }
         .detail-field-group ul {
            list-style-type: disc;
            padding-left: 20px;
            text-align: left;
        }
        .detail-field-group li {
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="index.html">이달의 영업포인트</a></li>
                <li><a href="guide.html">하이오더매니저</a></li>
                <li><a href="search.html">하이오더 매뉴얼</a></li>                
                <li><a href="voc.html">VOC 분석</a></li>
                <li><a href="materials.html" class="active">하이오더 관련 지식</a></li>
                <li><a href="exam_materials.html">하이오더마스터 시험자료</a></li>
                <li><a href="related_sites.html">관련 사이트</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <div class="container">
             <a href="materials.html" class="back-link">&larr; 자료실로 돌아가기</a>
            <div class="detail-card">
                <h1 class="detail-sub-category">하이오더-POS 연동 상세 가이드</h1>
                <p class="detail-sub-item">시스템 연동 절차 및 데이터 흐름 상세 설명</p>

                <div class="detail-field-group">
                    <h2 class="detail-field-title">1. 시스템 연동 초기 설정</h2>
                    <ul>
                        <li><strong>연동 방식 선택:</strong> 웹(POST) 또는 소켓(TCP/IP) 방식 중 하나를 최초에 결정해야 하며, 변경은 불가능합니다. (Port: 8090)</li>
                        <li><strong>API 개발:</strong> '필수'로 명시된 API는 반드시 개발해야 합니다.</li>
                    </ul>
                </div>

                <div class="detail-field-group">
                    <h2 class="detail-field-title">2. 하이오더 초기 데이터 요청 (하이오더 → POS)</h2>
                    <p>연동 시작 시, 하이오더는 POS에 필요한 기본 정보를 요청합니다. POS는 '터치키에 등록된' 활성 데이터만 응답해야 합니다.</p>
                    <div class="code-block">
// 상품 분류 요청
{ "cmd": "goods_group_list" }

// 상품 데이터 요청 (최대 200개)
{ "cmd": "goods_data_list" }

// 옵션 분류 및 데이터 요청
{ "cmd": "option_group_list" }
{ "cmd": "option_data_list" }

// 테이블 정보 요청
{ "cmd": "table_data_list" }
                    </div>
                </div>
                
                <div class="detail-field-group">
                    <h2 class="detail-field-title">3. 주문 처리 과정</h2>
                    <h4>주문 등록 (하이오더 → POS)</h4>
                    <p>하이오더에서 생성된 주문을 POS로 전달합니다. POS는 이 요청을 받아 처리해야 합니다.</p>
                    <div class="code-block">{ "cmd": "order_reg", "order_link_code": "...", ... }</div>
                    <ul>
                        <li><strong>중복 검증:</strong> <code>order_link_code</code>를 기준으로 중복 주문을 반드시 확인하고, 중복 시 <code>result_code: 201</code>로 응답해야 합니다.</li>
                        <li><strong>응답 시점:</strong> 상품을 POS에 완전히 적재한 후 <code>result_code: 200</code>을 반환하는 것이 원칙입니다. 실시간 처리가 어렵다면, 우선 200을 반환하고 3분 내 주문 실패 시 별도의 '주문 실패' 콜백을 보내야 합니다.</li>
                        <li><strong>선불 처리:</strong> 선불 매장의 경우, 주문을 POS 테이블에 '선금'으로 기록하거나, 테이블 적재 없이 주방 빌지만 출력하고 완료 처리하는 두 가지 방식 중 선택하여 개발할 수 있습니다.</li>
                    </ul>

                    <h4>매출 취소 및 퇴장 (하이오더 → POS, 선불 전용)</h4>
                    <p>하이오더에서 발생한 선불 결제 취소나 테이블 퇴장 정보를 POS에 동기화합니다.</p>
                    <div class="code-block">
// 매출 취소
{ "cmd": "order_cancel", "pos_order_num": "...", "order_link_code": "..." }

// 퇴장 처리
{ "cmd": "table_out", "table_data_pos_code": "..." }
                    </div>
                </div>

                <div class="detail-field-group">
                    <h2 class="detail-field-title">4. POS 이벤트 콜백 (POS → 하이오더)</h2>
                    <p>POS에서 발생한 주요 이벤트를 사전에 등록된 콜백 URL로 하이오더 서버에 전송합니다.</p>
                     <ul>
                        <li><strong>주문 취소/실패:</strong> POS에서 주문이 취소되거나 실패했을 때 하이오더에 알립니다. (<code>order_cancel</code>, <code>order_false</code>)</li>
                        <li><strong>자동 퇴장:</strong> POS에서 계산이 완료되거나(<code>table_out</code>), 테이블이 이동(<code>table_move</code>)되었을 때 하이오더에 해당 테이블의 퇴장을 알립니다.</li>
                        <li><strong>품절 처리 (선택):</strong> POS에서 특정 상품이 품절 처리되면 실시간으로 하이오더에 상태를 전송합니다. (<code>goods_stock</code>)</li>
                    </ul>
                </div>
            </div>
        </div>
    </main>
    <footer>
        <p>&copy; 2025 Hiorder Master Certification Training Center. All rights reserved.</p>
    </footer>
</body>
</html>
